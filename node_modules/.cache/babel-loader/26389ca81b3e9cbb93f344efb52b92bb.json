{"ast":null,"code":"import _regeneratorRuntime from \"/home/u/repos/arbitrator-integration-demo/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/u/repos/arbitrator-integration-demo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/u/repos/arbitrator-integration-demo/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/u/repos/arbitrator-integration-demo/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/u/repos/arbitrator-integration-demo/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/u/repos/arbitrator-integration-demo/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/u/repos/arbitrator-integration-demo/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/u/repos/arbitrator-integration-demo/src/Dashboard.js\";\nimport web3 from './ethereum/web3';\nimport React from 'react';\nimport { arbitratorInstance, getOwner, getArbitrationCost, getDispute, getDisputeStatus, setArbitrationPrice, disputeCreationEvent } from './ethereum/centralizedArbitrator';\nimport { arbitrableInstanceAt } from './ethereum/multipleArbitrableTransaction';\nimport Disputes from './Disputes';\n\nvar Dashboard =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Dashboard, _React$Component);\n\n  function Dashboard() {\n    var _this;\n\n    _classCallCheck(this, Dashboard);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Dashboard).call(this));\n\n    _this.addDispute =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var disputes, disputeID, dispute, length;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                disputes = _this.state.disputes;\n                disputeID = event.returnValues._disputeID;\n                _context.next = 4;\n                return getDispute(disputeID);\n\n              case 4:\n                dispute = _context.sent;\n                console.log(dispute);\n                length = disputes.push(dispute);\n                disputes[length - 1].key = disputeID;\n                arbitrableInstanceAt(event.returnValues._arbitrable).events.Ruling({}, {\n                  fromBlock: 0,\n                  toBlock: \"latest\"\n                }).on('data', function (event) {\n                  _this.updateDispute(event);\n                });\n\n                _this.setState({\n                  disputes: disputes\n                });\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.updateDispute =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(event) {\n        var disputes;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                disputes = _this.state.disputes;\n                disputes[event.returnValues._disputeID].ruling = event.returnValues[3];\n                _context2.next = 4;\n                return getDisputeStatus(event.returnValues._disputeID);\n\n              case 4:\n                disputes[event.returnValues._disputeID].status = _context2.sent;\n\n                _this.setState({\n                  disputes: disputes\n                });\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.setArbitrationCost =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(newCost) {\n        var arbitrationCost;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _this.setState({\n                  arbitrationCost: \"awaiting...\"\n                });\n\n                _context3.next = 3;\n                return setArbitrationPrice(newCost);\n\n              case 3:\n                _context3.next = 5;\n                return getArbitrationCost(\"\");\n\n              case 5:\n                arbitrationCost = _context3.sent;\n\n                _this.setState({\n                  arbitrationCost: arbitrationCost\n                });\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      owner: \"\",\n      arbitrationCost: \"\",\n      disputes: []\n    };\n    return _this;\n  }\n\n  _createClass(Dashboard, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var _this2 = this;\n\n        var owner, arbitrationCost, result;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return getOwner();\n\n              case 2:\n                owner = _context4.sent;\n                _context4.next = 5;\n                return getArbitrationCost(\"\");\n\n              case 5:\n                arbitrationCost = _context4.sent;\n                this.setState({\n                  owner: owner,\n                  arbitrationCost: arbitrationCost\n                });\n                arbitratorInstance.events.DisputeCreation({}, {\n                  fromBlock: 0,\n                  toBlock: \"latest\"\n                }).on('data', function (event) {\n                  _this2.addDispute(event);\n                }).on('changed', function (event) {// remove event from local database\n                }).on('error', console.error);\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      return function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, \"Owner: \", web3.eth.accounts[0] == this.state.owner ? \"You\" : this.state.owner), React.createElement(\"form\", {\n        onSubmit: function onSubmit(e) {\n          e.preventDefault();\n\n          _this3.setArbitrationCost(_this3.state.arbitrationCost);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }, \"Arbitration Price: \", React.createElement(\"input\", {\n        type: \"text\",\n        value: this.state.arbitrationCost,\n        onChange: function onChange(e) {\n          _this3.setState({\n            arbitrationCost: e.target.value\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        type: \"submit\",\n        value: \"Change Price\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }))), React.createElement(Disputes, {\n        items: this.state.disputes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Dashboard;\n}(React.Component);\n\nexport default Dashboard;","map":{"version":3,"sources":["/home/u/repos/arbitrator-integration-demo/src/Dashboard.js"],"names":["web3","React","arbitratorInstance","getOwner","getArbitrationCost","getDispute","getDisputeStatus","setArbitrationPrice","disputeCreationEvent","arbitrableInstanceAt","Disputes","Dashboard","addDispute","event","disputes","state","disputeID","returnValues","_disputeID","dispute","console","log","length","push","key","_arbitrable","events","Ruling","fromBlock","toBlock","on","updateDispute","setState","ruling","status","setArbitrationCost","newCost","arbitrationCost","owner","DisputeCreation","error","eth","accounts","e","preventDefault","target","value","Component"],"mappings":"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","sourcesContent":["import web3 from './ethereum/web3'\nimport React from 'react';\nimport {arbitratorInstance, getOwner, getArbitrationCost, getDispute, getDisputeStatus, setArbitrationPrice, disputeCreationEvent} from './ethereum/centralizedArbitrator'\nimport {arbitrableInstanceAt} from './ethereum/multipleArbitrableTransaction'\nimport Disputes from './Disputes'\n\nclass Dashboard extends React.Component {\n  constructor() {\n    super()\n    this.state = {\n      owner: \"\",\n      arbitrationCost: \"\",\n      disputes: []\n    }\n  }\n  async componentDidMount(){\n    const owner = await getOwner()\n    const arbitrationCost = await getArbitrationCost(\"\")\n    this.setState({owner, arbitrationCost})\n\n    let result\n    arbitratorInstance.events.DisputeCreation({}, {fromBlock: 0, toBlock: \"latest\"})\n    .on('data', (event) => {\n        this.addDispute(event)\n    })\n    .on('changed', function(event){\n        // remove event from local database\n    })\n    .on('error', console.error);\n\n\n  }\n\n  addDispute = async (event) => {\n\n    let disputes = this.state.disputes\n    let disputeID = event.returnValues._disputeID\n\n    let dispute = await getDispute(disputeID)\n    console.log(dispute)\n    const length = disputes.push(dispute)\n    disputes[length-1].key = disputeID\n\n    arbitrableInstanceAt(event.returnValues._arbitrable).events.Ruling({}, {fromBlock: 0, toBlock: \"latest\"})\n    .on('data', (event) => {\n      this.updateDispute(event)\n    })\n\n    this.setState({disputes: disputes})\n  }\n\n  updateDispute = async (event) => {\n    let disputes = this.state.disputes\n    disputes[event.returnValues._disputeID].ruling = event.returnValues[3]\n    disputes[event.returnValues._disputeID].status = await getDisputeStatus(event.returnValues._disputeID)\n    this.setState({disputes: disputes})\n  }\n\n  setArbitrationCost = async (newCost) => {\n    this.setState({arbitrationCost: \"awaiting...\"})\n    await setArbitrationPrice(newCost)\n    const arbitrationCost = await getArbitrationCost(\"\")\n    this.setState({arbitrationCost})\n  }\n\n\n  render() {\n    return (\n      <div>\n        <h4>Owner: {web3.eth.accounts[0] == this.state.owner ? \"You\" : this.state.owner}</h4>\n        <form onSubmit={(e) => {e.preventDefault();this.setArbitrationCost(this.state.arbitrationCost)}}>\n          <label>\n            Arbitration Price: <input type=\"text\" value={this.state.arbitrationCost} onChange={(e) => {this.setState({arbitrationCost: e.target.value})}} />\n            <input type=\"submit\" value=\"Change Price\" />\n          </label>\n        </form>\n        <Disputes items={this.state.disputes}/>\n      </div>\n    )\n  }\n}\n\nexport default Dashboard\n"]},"metadata":{},"sourceType":"module"}